# 01. Task Parser Specification

**Component**: Task Extraction Engine - Phase 1  
**Purpose**: Parse @plan output and extract concrete tasks  
**Date**: January 13, 2026  
**Status**: Specification

---

## ğŸ“– Overview

The Task Parser reads the ProjectPlan folder (generated by @plan) and converts the high-level specification into a structured task list that agents can execute.

**Input**: `ProjectPlan/` folder with JSON specifications  
**Output**: `task-list.json` with all extracted tasks

---

## ğŸ”„ Process Flow

```
ProjectPlan folder structure (from @plan)
â”œâ”€â”€ project-plan.json          â”€â”
â”œâ”€â”€ tech-stack.json            â”€â”¼â”€â”€> TASK PARSER â”€â”€> task-list.json
â”œâ”€â”€ features.json              â”€â”¤
â”œâ”€â”€ constraints.json           â”€â”˜
â””â”€â”€ phases.json
```

---

## ğŸ“¥ Input Specification

### 1. project-plan.json
```json
{
  "project_name": "MyApp",
  "organization": "company",
  "description": "Full-stack web application",
  "business_goals": [
    "Reduce manual workflows by 50%",
    "Improve team productivity"
  ],
  "stakeholders": ["Manager", "Tech Lead"],
  "timeline_weeks": 12,
  "team_size": 5,
  "budget_usd": 50000
}
```

### 2. tech-stack.json
```json
{
  "backend": {
    "framework": "express",
    "runtime": "nodejs",
    "version": "18.0"
  },
  "frontend": {
    "framework": "react",
    "build_tool": "vite",
    "version": "18.0"
  },
  "database": {
    "primary": "postgresql",
    "cache": "redis"
  },
  "infrastructure": {
    "cloud": "azure",
    "iac": "bicep",
    "containerization": "docker"
  },
  "ci_cd": "github-actions",
  "monitoring": "application-insights"
}
```

### 3. features.json
```json
{
  "features": [
    {
      "id": "F001",
      "name": "User Authentication",
      "description": "Email/password login with JWT",
      "priority": 1,
      "complexity": "medium",
      "acceptance_criteria": [
        "Users can register",
        "Users can login",
        "JWT tokens issued",
        "Protected routes work"
      ],
      "affects": ["backend", "frontend", "database"]
    },
    {
      "id": "F002",
      "name": "API Endpoints",
      "description": "RESTful API for business logic",
      "priority": 1,
      "complexity": "high",
      "acceptance_criteria": [
        "CRUD endpoints created",
        "Input validation",
        "Error handling",
        "OpenAPI documentation"
      ],
      "affects": ["backend", "database"]
    }
  ]
}
```

### 4. constraints.json
```json
{
  "timeline": {
    "total_weeks": 12,
    "phases": 3
  },
  "team": {
    "size": 5,
    "roles": ["Frontend Dev", "Backend Dev", "DevOps", "QA", "Lead"]
  },
  "technical": {
    "test_coverage_min": 0.75,
    "uptime_sla": "99.5%",
    "response_time_p95_ms": 500
  },
  "compliance": ["GDPR", "SOC2"]
}
```

---

## ğŸ“¤ Output Specification

### task-list.json
```json
{
  "project_name": "MyApp",
  "generated_at": "2026-01-13T10:00:00Z",
  "total_tasks": 42,
  "tasks": [
    {
      "id": "TASK_001",
      "title": "Initialize Express Application",
      "description": "Create base Express app with routing structure",
      "type": "backend-setup",
      "category": "infrastructure",
      "priority": 1,
      "phase": 13,
      "agent": "@nodejs-specialist",
      "feature_id": null,
      "depends_on": [],
      "estimated_hours": 2,
      "acceptance_criteria": [
        "Express app created",
        "Basic routing configured",
        "Server listens on port 3000",
        "Health check endpoint /health returns 200"
      ],
      "inputs": {
        "framework": "express",
        "runtime": "nodejs",
        "version": "18.0",
        "port": 3000
      },
      "outputs": {
        "app_structure": "src/",
        "main_file": "src/server.ts",
        "config_files": ["src/config.ts"]
      },
      "tags": ["backend", "nodejs", "setup"]
    },
    {
      "id": "TASK_002",
      "title": "Create PostgreSQL Database Schema",
      "description": "Design and create tables for User, Post, Comment",
      "type": "database-schema",
      "category": "data",
      "priority": 1,
      "phase": 12,
      "agent": "@database-specialist",
      "feature_id": "F001",
      "depends_on": [],
      "estimated_hours": 3,
      "acceptance_criteria": [
        "Users table created",
        "Posts table created",
        "Relationships defined",
        "Indexes created",
        "Migration script generated"
      ],
      "inputs": {
        "database": "postgresql",
        "tables": ["users", "posts", "comments"],
        "relationships": "user:post=1:many"
      },
      "outputs": {
        "schema_file": "db/schema.sql",
        "migration": "db/migrations/001_init.sql"
      },
      "tags": ["database", "postgresql", "schema"]
    },
    {
      "id": "TASK_003",
      "title": "Setup Authentication Middleware",
      "description": "Create JWT auth middleware for protected routes",
      "type": "backend-feature",
      "category": "authentication",
      "priority": 1,
      "phase": 13,
      "agent": "@nodejs-specialist",
      "feature_id": "F001",
      "depends_on": ["TASK_001"],
      "estimated_hours": 3,
      "acceptance_criteria": [
        "JWT middleware created",
        "Token verification works",
        "Protected routes block unauthorized",
        "Tests pass (80% coverage)"
      ],
      "inputs": {
        "auth_type": "jwt",
        "secret_env": "JWT_SECRET",
        "token_expiry": 3600
      },
      "outputs": {
        "middleware_file": "src/middleware/auth.ts",
        "test_file": "src/middleware/auth.test.ts"
      },
      "tags": ["authentication", "jwt", "nodejs"]
    },
    {
      "id": "TASK_004",
      "title": "Create Authentication API Routes",
      "description": "POST /register, POST /login endpoints",
      "type": "backend-feature",
      "category": "api",
      "priority": 1,
      "phase": 13,
      "agent": "@nodejs-specialist",
      "feature_id": "F001",
      "depends_on": ["TASK_003", "TASK_002"],
      "estimated_hours": 3,
      "acceptance_criteria": [
        "Register endpoint works",
        "Login endpoint returns JWT",
        "Password hashing implemented",
        "Error handling correct",
        "OpenAPI docs generated"
      ],
      "inputs": {
        "auth_type": "jwt",
        "password_hashing": "bcrypt"
      },
      "outputs": {
        "routes_file": "src/routes/auth.ts",
        "test_file": "src/routes/auth.test.ts"
      },
      "tags": ["api", "authentication", "nodejs"]
    },
    {
      "id": "TASK_010",
      "title": "Create React Login Component",
      "description": "Login form with email/password fields",
      "type": "frontend-feature",
      "category": "ui",
      "priority": 1,
      "phase": 14,
      "agent": "@react-specialist",
      "feature_id": "F001",
      "depends_on": ["TASK_004"],
      "estimated_hours": 3,
      "acceptance_criteria": [
        "Login form renders",
        "Form validation works",
        "API call to backend",
        "Token stored in localStorage",
        "Redirects on success"
      ],
      "inputs": {
        "framework": "react",
        "state_management": "zustand",
        "styling": "tailwindcss"
      },
      "outputs": {
        "component_file": "src/components/LoginForm.tsx",
        "test_file": "src/components/LoginForm.test.tsx"
      },
      "tags": ["frontend", "react", "authentication"]
    }
  ]
}
```

---

## ğŸ¯ Extraction Algorithm

### Step 1: Parse Features into Feature Tasks
For each feature in features.json:
```json
Feature: "User Authentication"
â”‚
â”œâ”€> Task: "Setup JWT middleware"
â”œâ”€> Task: "Create auth routes"
â”œâ”€> Task: "Create login component"
â”œâ”€> Task: "Create register component"
â”œâ”€> Task: "Write tests"
â””â”€> Task: "Create documentation"
```

### Step 2: Add Infrastructure Tasks
Based on tech-stack.json:
```
Backend: Express
â”œâ”€> TASK: Initialize Express app
â”œâ”€> TASK: Setup routing
â”œâ”€> TASK: Configure logging
â”œâ”€> TASK: Setup error handling
â””â”€> TASK: Create config system

Database: PostgreSQL
â”œâ”€> TASK: Create schema
â”œâ”€> TASK: Setup migrations
â”œâ”€> TASK: Create indexes
â””â”€> TASK: Write tests

Infrastructure: Azure + Bicep
â”œâ”€> TASK: Create resource groups
â”œâ”€> TASK: Create App Service
â”œâ”€> TASK: Create SQL Database
â”œâ”€> TASK: Create storage
â””â”€> TASK: Setup networking
```

### Step 3: Determine Dependencies
```
Feature F001 depends on:
  - TASK_001 (Initialize Express) â†’ no deps
  - TASK_002 (DB Schema) â†’ no deps
  - TASK_003 (Auth Middleware) â†’ TASK_001
  - TASK_004 (Auth Routes) â†’ TASK_003, TASK_002
  - TASK_010 (Login Component) â†’ TASK_004
  - TASK_011 (Register Component) â†’ TASK_004
```

### Step 4: Assign to Agents
Based on tech-stack and phase-flow:
```
Express task â†’ @nodejs-specialist (Phase 13)
React task â†’ @react-specialist (Phase 14)
DB task â†’ @database-specialist (Phase 12)
Bicep task â†’ @bicep-specialist (Phase 11)
```

### Step 5: Calculate Estimates
```
Sum by feature:
  F001 (Auth) = 15 hours
  F002 (API) = 20 hours
  Infrastructure = 25 hours
  Testing = 15 hours
  Documentation = 10 hours
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Total: 85 hours
  Estimate: 12 weeks (5 people Ã— 40h = 200h available)
  âœ“ Feasible
```

---

## ğŸ·ï¸ Task Types

| Type | Agent | Phase | Example |
|------|-------|-------|---------|
| backend-setup | @nodejs-specialist, @dotnet-specialist | 13 | Initialize Express app |
| backend-feature | @nodejs-specialist, @dotnet-specialist | 13 | Create API route |
| frontend-setup | @react-specialist, @vue-specialist | 14 | Create React app |
| frontend-feature | @react-specialist, @vue-specialist | 14 | Create login form |
| database-schema | @database-specialist | 12 | Create PostgreSQL schema |
| database-feature | @database-specialist | 12 | Add indexes |
| infrastructure | @azure-architect, @bicep-specialist | 9-11 | Setup Azure resources |
| testing | @qa | 5 | Write test suite |
| documentation | @doc | 2 | Create API docs |

---

## ğŸ”— Task Linking

Tasks can reference features:
```json
{
  "feature_id": "F001",           // What feature this implements
  "depends_on": ["TASK_003"],     // Prerequisites
  "blocks": ["TASK_010"],         // What this blocks
  "related": ["TASK_005"]         // Parallel tasks
}
```

---

## âš™ï¸ Configuration

### task-parser.config.json
```json
{
  "feature_task_ratio": 1.5,      // Each feature = 1.5 tasks (estimate multiplier)
  "infrastructure_multiplier": 1.3,
  "testing_multiplier": 0.4,
  "documentation_multiplier": 0.2,
  "default_priority": 2,
  "max_parallel_tasks": 10,
  "acceptance_criteria_min": 3,
  "task_naming_pattern": "TASK_{sequence:03d}"
}
```

---

## âœ… Validation Rules

Task Parser must validate:

1. âœ… All tasks have unique IDs
2. âœ… All dependencies exist
3. âœ… No circular dependencies
4. âœ… All tasks have agents assigned
5. âœ… All tasks have acceptance criteria (min 2)
6. âœ… Estimated hours reasonable (1-40 per task)
7. âœ… Phases match agent phases from phase-flow.gv
8. âœ… All features have at least one task
9. âœ… Critical path calculable

---

## ğŸ“Š Output Statistics

task-list.json should include metadata:
```json
{
  "metadata": {
    "total_features": 8,
    "total_tasks": 42,
    "total_estimated_hours": 120,
    "tasks_by_agent": {
      "@nodejs-specialist": 15,
      "@react-specialist": 12,
      "@database-specialist": 8,
      "@bicep-specialist": 4,
      "@qa": 2,
      "@doc": 1
    },
    "tasks_by_type": {
      "backend-feature": 15,
      "frontend-feature": 12,
      "database-schema": 3,
      "infrastructure": 4,
      "testing": 6,
      "documentation": 2
    },
    "critical_path_hours": 45
  }
}
```

---

## ğŸš€ Implementation Notes

### Technology Stack
- Node.js + TypeScript
- JSON Schema validation
- Graph library (for dependency analysis)
- Timing/estimation library

### Key Algorithms
1. **Feature expansion** - Convert feature to tasks
2. **Dependency analysis** - Topological sort
3. **Critical path** - Find longest dependency chain
4. **Parallel block identification** - Find parallelizable tasks

### Edge Cases to Handle
- Circular dependencies â†’ Error with path
- Missing dependencies â†’ Auto-create or error
- Impossible timeline â†’ Flag as warning
- Too many parallel tasks â†’ Stage in blocks

---

## ğŸ“– Examples

See `examples/example-tasks.json` for complete worked example.

---

**Next**: Read `02_dependency-resolver.md` to understand how tasks are scheduled.
