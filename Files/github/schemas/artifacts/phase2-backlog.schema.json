{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://agenticcoder.com/schemas/artifacts/phase2-backlog.schema.json",
  "title": "Phase 2 Backlog Artifact Schema",
  "description": "Schema for Phase 2 output: backlog artifacts created by @backlog agent",
  "type": "object",
  "required": ["artifact_type", "phase", "created_by", "backlog"],
  "properties": {
    "artifact_type": {
      "type": "string",
      "const": "phase2-backlog",
      "description": "Artifact type identifier"
    },
    "phase": {
      "type": "integer",
      "const": 2,
      "description": "Phase number"
    },
    "created_by": {
      "type": "string",
      "const": "@backlog",
      "description": "Agent that created this artifact"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Creation timestamp"
    },
    "backlog": {
      "type": "object",
      "required": ["epics", "stories", "nfrs", "risks", "release_plan"],
      "properties": {
        "epics": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "name", "status", "priority", "estimated_effort"],
            "properties": {
              "id": {"type": "string", "pattern": "^EPIC-[0-9]+$"},
              "name": {"type": "string"},
              "status": {
                "type": "string",
                "enum": ["Backlog", "In Progress", "Done"]
              },
              "priority": {
                "type": "string",
                "enum": ["Critical", "High", "Medium", "Low"]
              },
              "estimated_effort": {
                "type": "integer",
                "minimum": 1,
                "description": "Number of stories"
              },
              "business_value": {
                "type": "string",
                "enum": ["High", "Medium", "Low"]
              },
              "technical_risk": {
                "type": "string",
                "enum": ["High", "Medium", "Low"]
              },
              "dependencies": {
                "type": "array",
                "items": {"type": "string"},
                "description": "IDs of epics this depends on"
              }
            }
          },
          "minItems": 1,
          "description": "List of epics"
        },
        "stories": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "epic_id", "title", "story_points"],
            "properties": {
              "id": {"type": "string", "pattern": "^STORY-[0-9]+$"},
              "epic_id": {"type": "string", "pattern": "^EPIC-[0-9]+$"},
              "title": {"type": "string"},
              "story_points": {
                "type": "integer",
                "enum": [1, 2, 3, 5, 8, 13, 21],
                "description": "Fibonacci story points"
              },
              "acceptance_criteria_count": {
                "type": "integer",
                "minimum": 1,
                "description": "Number of acceptance criteria"
              },
              "dependencies": {
                "type": "array",
                "items": {"type": "string"},
                "description": "IDs of stories this depends on"
              }
            }
          },
          "minItems": 1,
          "description": "List of user stories"
        },
        "nfrs": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "category", "requirement", "target"],
            "properties": {
              "id": {"type": "string", "pattern": "^NFR-[0-9]+$"},
              "category": {
                "type": "string",
                "enum": [
                  "Performance",
                  "Security",
                  "Reliability",
                  "Scalability",
                  "Maintainability",
                  "Usability",
                  "Compliance"
                ]
              },
              "requirement": {"type": "string"},
              "target": {"type": "string"},
              "measurement": {"type": "string"},
              "owner": {"type": "string"}
            }
          },
          "description": "Non-functional requirements"
        },
        "risks": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["id", "description", "probability", "impact"],
            "properties": {
              "id": {"type": "string", "pattern": "^RISK-[0-9]+$"},
              "description": {"type": "string"},
              "probability": {
                "type": "string",
                "enum": ["High", "Medium", "Low"]
              },
              "impact": {
                "type": "string",
                "enum": ["High", "Medium", "Low"]
              },
              "overall_risk_level": {
                "type": "string",
                "enum": ["Critical", "High", "Medium", "Low"]
              },
              "mitigation_strategy": {"type": "string"},
              "owner": {"type": "string"}
            }
          },
          "description": "Identified risks"
        },
        "release_plan": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["release_name", "target_date", "epics_included"],
            "properties": {
              "release_name": {"type": "string"},
              "target_date": {
                "type": "string",
                "format": "date"
              },
              "epics_included": {
                "type": "array",
                "items": {"type": "string"}
              },
              "go_no_go_criteria": {
                "type": "array",
                "items": {"type": "string"}
              }
            }
          },
          "minItems": 1,
          "description": "Release milestones"
        }
      }
    },
    "summary": {
      "type": "object",
      "required": ["total_epics", "total_stories", "total_story_points"],
      "properties": {
        "total_epics": {"type": "integer", "minimum": 1},
        "total_stories": {"type": "integer", "minimum": 1},
        "total_story_points": {"type": "integer", "minimum": 1},
        "total_nfrs": {"type": "integer", "minimum": 0},
        "total_risks": {"type": "integer", "minimum": 0},
        "total_releases": {"type": "integer", "minimum": 1},
        "high_risk_count": {"type": "integer", "minimum": 0}
      }
    }
  }
}
