{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "networking-specialist.input.schema.json",
  "title": "Networking Specialist Input Schema",
  "description": "Input schema for Azure Networking (VNets, NSGs, Private Endpoints, Firewall) specialist requests",
  "type": "object",
  "required": ["requestType", "networkTopology"],
  "properties": {
    "requestType": {
      "type": "string",
      "enum": [
        "vnet-design",
        "hub-spoke",
        "nsg-rules",
        "private-endpoint",
        "firewall-setup",
        "load-balancing",
        "vpn-gateway",
        "expressroute",
        "dns-configuration",
        "network-security",
        "infrastructure",
        "review"
      ],
      "description": "Type of networking request"
    },
    "networkTopology": {
      "type": "string",
      "enum": ["single-vnet", "hub-spoke", "mesh", "hybrid"],
      "description": "Network topology pattern"
    },
    "vnetConfig": {
      "type": "object",
      "properties": {
        "vnets": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "addressSpace": { "type": "string" },
              "location": { "type": "string" },
              "purpose": {
                "type": "string",
                "enum": ["hub", "spoke-production", "spoke-development", "spoke-shared"]
              },
              "subnets": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": { "type": "string" },
                    "addressPrefix": { "type": "string" },
                    "purpose": { "type": "string" },
                    "delegation": { "type": "string" },
                    "serviceEndpoints": {
                      "type": "array",
                      "items": { "type": "string" }
                    }
                  }
                }
              }
            }
          },
          "description": "VNet definitions"
        },
        "peering": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean" },
            "allowGatewayTransit": { "type": "boolean" },
            "useRemoteGateways": { "type": "boolean" }
          }
        }
      }
    },
    "nsgConfig": {
      "type": "object",
      "properties": {
        "nsgs": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "attachTo": { "type": "string" },
              "rules": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": { "type": "string" },
                    "direction": { "type": "string", "enum": ["Inbound", "Outbound"] },
                    "access": { "type": "string", "enum": ["Allow", "Deny"] },
                    "protocol": { "type": "string" },
                    "sourceAddress": { "type": "string" },
                    "destinationPort": { "type": "string" },
                    "priority": { "type": "number" }
                  }
                }
              }
            }
          }
        },
        "applicationSecurityGroups": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "purpose": { "type": "string" }
            }
          }
        },
        "flowLogs": {
          "type": "boolean",
          "description": "Enable NSG Flow Logs"
        }
      }
    },
    "privateEndpointConfig": {
      "type": "object",
      "properties": {
        "endpoints": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "resourceType": {
                "type": "string",
                "enum": ["storage", "sql", "cosmos", "keyvault", "webapp", "acr", "servicebus", "eventhub"]
              },
              "subResource": { "type": "string" },
              "subnet": { "type": "string" }
            }
          }
        },
        "privateDnsZones": {
          "type": "boolean",
          "description": "Create private DNS zones"
        },
        "dnsIntegration": {
          "type": "string",
          "enum": ["azure-private-dns", "custom-dns", "hybrid"]
        }
      }
    },
    "firewallConfig": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "sku": {
          "type": "string",
          "enum": ["Standard", "Premium", "Basic"]
        },
        "threatIntelMode": {
          "type": "string",
          "enum": ["Off", "Alert", "Deny"]
        },
        "applicationRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "targetFqdns": { "type": "array", "items": { "type": "string" } },
              "protocols": { "type": "array", "items": { "type": "string" } }
            }
          }
        },
        "networkRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "sourceAddresses": { "type": "array", "items": { "type": "string" } },
              "destinationAddresses": { "type": "array", "items": { "type": "string" } },
              "destinationPorts": { "type": "array", "items": { "type": "string" } },
              "protocols": { "type": "array", "items": { "type": "string" } }
            }
          }
        },
        "dnatRules": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "publicIp": { "type": "string" },
              "translatedAddress": { "type": "string" },
              "translatedPort": { "type": "string" }
            }
          }
        }
      }
    },
    "loadBalancingConfig": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["application-gateway", "load-balancer", "front-door", "traffic-manager"]
        },
        "sku": { "type": "string" },
        "wafEnabled": { "type": "boolean" },
        "backendPools": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": { "type": "string" },
              "targets": { "type": "array", "items": { "type": "string" } }
            }
          }
        }
      }
    },
    "hybridConnectivity": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["vpn-gateway", "expressroute", "both"]
        },
        "onPremisesAddressSpace": {
          "type": "array",
          "items": { "type": "string" }
        },
        "vpnType": {
          "type": "string",
          "enum": ["RouteBased", "PolicyBased"]
        },
        "activeActive": { "type": "boolean" }
      }
    },
    "bastionConfig": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "sku": {
          "type": "string",
          "enum": ["Basic", "Standard"]
        },
        "features": {
          "type": "object",
          "properties": {
            "tunneling": { "type": "boolean" },
            "fileCopy": { "type": "boolean" },
            "sharableLink": { "type": "boolean" }
          }
        }
      }
    },
    "dnsConfig": {
      "type": "object",
      "properties": {
        "customDnsServers": {
          "type": "array",
          "items": { "type": "string" }
        },
        "privateDnsZones": {
          "type": "array",
          "items": { "type": "string" }
        },
        "dnsResolver": {
          "type": "boolean"
        }
      }
    },
    "ddosProtection": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "planType": {
          "type": "string",
          "enum": ["Basic", "Standard"]
        }
      }
    },
    "context": {
      "type": "object",
      "properties": {
        "existingNetwork": { "type": "string" },
        "complianceRequirements": {
          "type": "array",
          "items": { "type": "string" }
        },
        "budgetConstraint": { "type": "string" }
      }
    }
  }
}
